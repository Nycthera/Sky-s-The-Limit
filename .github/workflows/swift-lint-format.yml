name: Swift Lint & Format

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  lint-format:
    name: Lint and Format Swift Code
    runs-on: macos-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install Homebrew
        run: |
          /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
          echo 'eval "$(/opt/homebrew/bin/brew shellenv)"' >> $GITHUB_ENV
          eval "$(/opt/homebrew/bin/brew shellenv)"

      - name: Install SwiftLint and SwiftFormat
        run: |
          brew install swiftlint
          brew install swiftformat

      - name: Run SwiftLint
        run: swiftlint

      - name: Run SwiftFormat
        run: swiftformat .

      - name: Run Swift Built-in Formatter
        run: swift format --in-place --recursive Sources/

